<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>User interface</title>
    <link rel="stylesheet" type="text/css" href="styledata.css" />
    <link rel="icon" type="image/png" href="Images/User-interface.png" />
    <script>
      const submitBpm = function () {
        const min = 1;
        const max = 120;
        if (bpm.value < min || bpm.value > max) {
          alert('Impossible input. Please try again!');
        }
        document.querySelector('#bpm').value = null;
      };

      const submitNotes = function () {
        let newNotes = [...notes.value.split('-')];
        let notemax = 12;
        const possibleChoices = [
          '1',
          '2',
          '3',
          '4',
          '5',
          '6',
          '7',
          '8',
          '9',
          '10',
          '11',
          '12',
          'A',
          'A#',
          'B',
          'C',
          'C#',
          'D',
          'D#',
          'E',
          'F',
          'F#',
          'G',
          'G#',
          '%',
          '^',
          '!',
          '#',
          '@',
          '$',
        ];
        let check = 0;
        let j = 0;
        if (!notes.value.includes('-')) {
          alert('Please write the correct parameter = "-"');
          check = 1;
        }
        for (i in newNotes) {
          if (check !== 1) {
            if (!possibleChoices.includes(newNotes[i].toUpperCase())) {
              alert('Impossible input. Please try again!');
              check = 1;
            }
          }
          if (
            newNotes[i] == '%' ||
            newNotes[i] == '^' ||
            newNotes[i] == '!' ||
            newNotes[i] == '#' ||
            newNotes[i] == '@' ||
            newNotes[i] == '$'
          ) {
            j++;
          }
        }
        if (check !== 1) {
          if (newNotes.length - j > notemax) {
            alert(`Please write up to a ${notemax} note sequence!`);
          }
        }
        document.querySelector('#notes').value = null;
        const playNotes = function (note_name) {
          $.get(`http://172.24.1.1/metalo/note${note_name}.cgi`);
        };
      };
    </script>
  </head>
  <body>
    <h1 class="title">Your turn to produce music!</h1>
    <div>
      <button id="btnIndex" onclick="goIndex">Home</button>
      <p class="text">
        Now, you have the option to choose a bpm, which correponds to the speed
        used during the execution of the spetacle:
      </p>
      <div class="input">
        <label for="bpm">BPM(1 to 120):</label>
        <input type="number" id="bpm" name="bpm" />
        <button id="btnSubmit" onclick="submitBpm()">Submit</button>
      </div>
      <p class="text">
        Also, you may create a sequence of music notes as you like. Please,
        consider looking at the table or put it in the notes directly and write
        all of them at once, separating them by an hifen. In additon, you may
        use the symbols indicated below between two notes, in order to further
        personalize your music. Keep in mind that the sequence must be of a
        maximum of 12 notes. After, just wait for the incredible performance of
        our system.
      </p>
      <div class="tables">
        <table id="tableNotes">
          <tr>
            <th>Number</th>
            <th>Musical Note</th>
          </tr>
          <tr>
            <th>1</th>
            <th>A</th>
          </tr>
          <tr>
            <th>2</th>
            <th>A#</th>
          </tr>
          <tr>
            <th>3</th>
            <th>B</th>
          </tr>
          <tr>
            <th>4</th>
            <th>C</th>
          </tr>
          <tr>
            <th>5</th>
            <th>C#</th>
          </tr>
          <tr>
            <th>6</th>
            <th>D</th>
          </tr>
          <tr>
            <th>7</th>
            <th>D#</th>
          </tr>
          <tr>
            <th>8</th>
            <th>E</th>
          </tr>
          <tr>
            <th>9</th>
            <th>F</th>
          </tr>
          <tr>
            <th>10</th>
            <th>F#</th>
          </tr>
          <tr>
            <th>11</th>
            <th>G</th>
          </tr>
          <tr>
            <th>12</th>
            <th>G#</th>
          </tr>
        </table>

        <table id="tableSymbols">
          <tr>
            <th>Symbols</th>
            <th>Functionality</th>
          </tr>
          <tr>
            <th>%</th>
            <th>Delay*0.5</th>
          </tr>
          <tr>
            <th>^</th>
            <th>Delay*0.75</th>
          </tr>
          <tr>
            <th>!</th>
            <th>Delay*1.25</th>
          </tr>
          <tr>
            <th>#</th>
            <th>Delay*1.5</th>
          </tr>
          <tr>
            <th>@</th>
            <th>Delay*1.75</th>
          </tr>
          <tr>
            <th>$</th>
            <th>Delay*2</th>
          </tr>
        </table>
      </div>

      <div class="input">
        <label for="notes">Musical notes (max=12):</label>
        <input type="text" id="notes" name="notes" />
        <button id="btnSubmit" onclick="submitNotes()">Submit</button>
      </div>
    </div>

    <div class="button">
      <button class="btNote" onclick="playNotes('A')">A</button>
      <button class="btNote" onclick="playNotes('A#')">A#</button>
      <button class="btNote" onclick="playNotes('B')">B</button>
      <button class="btNote" onclick="playNotes('C')">C</button>
      <button class="btNote" onclick="playNotes('C#')">C#</button>
      <button class="btNote" onclick="playNotes('D')">D</button>
      <button class="btNote" onclick="playNotes('D#')">D#</button>
      <button class="btNote" onclick="playNotes('E')">E</button>
      <button class="btNote" onclick="playNotes('F')">F</button>
      <button class="btNote" onclick="playNotes('F#')">F#</button>
      <button class="btNote" onclick="playNotes('G')">G</button>
      <button class="btNote" onclick="playNotes('G#')">G#</button>
    </div>

    <script src="script.js" type="module"></script>
    <script src="jquery.js"></script>
  </body>
</html>
